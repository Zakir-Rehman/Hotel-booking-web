<%- layout("/layouts/boilerplate") -%>
<script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

<div class="flex items-center justify-center" style="min-height: 80vh;" >
<% const deals = allListings.filter(list => list.price < 15000); %>

<% if (deals.length > 0) { %>

  <div class="top-margin-div ">
    <h3 class="text-start text-wrap">Deals are available for low-priced hotels.</h3>
    <p class="px-[20px]">
      Our hotels offer exceptional comfort, modern facilities, and top-quality service â€” all at affordable prices.
    </p>
    <hr>

    <div class="cards-main-div flex flex-wrap max-sm:w-[100%] justify-center max-lg:justify-center max-lg:mt-[20px]">

      <% deals.forEach(listing => { %>
        <a href="/listings/<%= listing._id %>" class="a-link relative single-card">

          <div class="card max-sm:w-[100%] a-div">

            <img src="<%= listing.image.url %>" class="rounded-[0px] images-db" style="height: 14rem;" />

            <div class="card-img-overlay absolute flex justify-end top-[25px] w-[100%] h-[15px]">
              <span>
                 <a href="/listings/liked/<%= listing._id %>">
                      <!-- <i class="fa-regular fa-heart  text-[1.4rem]  hover:text-[4rem] hover:translate-y-[-30px] transition duration-200 ease-in  hover:blur-[2px] transition-transform font-semibold text-[red]"></i> -->
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="shadow-[0_0_2px_5px_white]  text-[1rem] text-[black] bg-[white] rounded-[50%]  hover:scale-120 transition duration-200 ease-in   transition-transform font-semibold"
                        aria-hidden="true">
                        <path
                          d="M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5">
                        </path>
                      </svg>
                    </a>
              </span>
            </div>

            <div class="card-body px-[3px] py-[3px]">
              <div class="card-text gst-div">

                <p>
                  <i class="fa-solid fa-hand-holding-dollar"></i>
                  from Rs <%= listing.price.toLocaleString("en-PK") %> / 2 night
                </p>

                <a href="/listings/<%= listing._id %>">
                  <p><i class="fa-solid fa-pencil"></i> <%= listing.title %></p>
                </a>

                <p class="text-info"><i class="fa-solid fa-plus"></i> 18% GST</p>

                <% if (listing.orderType || listing.bedrooms) { %>
                <p>
                  <i class="fa-solid fa-house"></i> <%= listing.orderType %>
                  <i class="fa-solid fa-bed"></i> Bedrooms <%= listing.bedrooms %>
                  <i class="fa-solid fa-user-group"></i> Guests <%= listing.guests %>
                </p>
                <% } %>

                <p>
                  <i class="fa-solid fa-location-dot"></i>
                  <%= listing.country %>, <%= listing.location %>
                </p>

              </div>
            </div>

          </div>
        </a>
      <% }) %>

    </div>
  </div>

<% } else { %>

  <!-- NO DEAL FOUND UI -->
  <div class="w-full flex flex-col items-center justify-center py-20 text-center">
    <div class="text-red-600 text-6xl mb-4 animate-bounce">
      <i class="fa-solid fa-circle-xmark"></i>
    </div>

    <h1 class="text-3xl font-bold bg-gradient-to-r from-red-500 to-rose-600 text-transparent bg-clip-text">
      No Deal Found
    </h1>

    <p class="text-gray-600 mt-2 text-lg">
      Sorry! No discounted hotels are available at the moment.
    </p>

    <a href="/listings"
      class="mt-5 px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl font-semibold shadow-lg transition">
      Explore Hotels
    </a>
  </div>

<% } %>

</div>
